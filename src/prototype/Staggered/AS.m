function U = AS(R)
    globals;
    U = zeros(P+2,N+2,Q+2,3);
    U(1:P+2,1:N+2,1:Q+2,:) = divAdj(R(1:P+1,1:N+1,1:Q+1));

    U(1:P+1,1  ,1:Q+1,1)   = U(1:P+1,1  ,1:Q+1,1) + R(1:P+1,N+3,1:Q+1);
    U(1:P+1,N+2,1:Q+1,1)   = U(1:P+1,N+2,1:Q+1,1) + R(1:P+1,N+2,1:Q+1);

    U(1  ,1:N+1,1:Q+1,2)   = U(1  ,1:N+1,1:Q+1,2) + R(P+3,1:N+1,1:Q+1);
    U(P+2,1:N+1,1:Q+1,2)   = U(P+2,1:N+1,1:Q+1,2) + R(P+2,1:N+1,1:Q+1);
    
    U(1:P+1,1:N+1,1  ,3)   = U(1:P+1,1:N+1,1  ,3) + R(1:P+1,1:N+1,Q+3);
    U(1:P+1,1:N+1,Q+2,3)   = U(1:P+1,1:N+1,Q+2,3) + R(1:P+1,1:N+1,Q+2) ;
end


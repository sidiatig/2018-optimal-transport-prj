function U = divAdj(D)
    globals;
    U = zeros(N+2,P+2,Q+2,3);
    
    U(1    ,1:P+1,1:Q+1,1) = -D(1,:,:) ;
    U(2:N+1,1:P+1,1:Q+1,1) = D(1:N,:,:) - D(2:N+1,:,:);
    U(N+2  ,1:P+1,1:Q+1,1) = D(N+1,:,:) ;
    U(:,:,:,1) = (N+1)*U(:,:,:,1);
    
    U(1:N+1,1    ,1:Q+1,2) = -D(:,1,:);
    U(1:N+1,2:P+1,1:Q+1,2) = D(:,1:P,:) - D(:,2:P+1,:);
    U(1:N+1,P+2  ,1:Q+1,2) = D(:,P+1,:);
    U(:,:,:,2) = (P+1)*U(:,:,:,2);
    
    U(1:N+1,1:P+1,1    ,3) = -D(:,:,1) ;
    U(1:N+1,1:P+1,2:Q+1,3) = D(:,:,1:Q) - D(:,:,2:Q+1);
    U(1:N+1,1:P+1,Q+2  ,3) = D(:,:,Q+1) ;
    U(:,:,:,3) = (Q+1)*U(:,:,:,3);
end

